
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The faststream-gen library uses advanced AI to generate FastStream code from application descriptions, speeding up FastStream app development.">
      
      
        <meta name="author" content="airt">
      
      
        <link rel="canonical" href="https://airtai.github.io/faststream-gen/Chat/">
      
      
      
      
      <link rel="icon" href="../overrides/images/airt_icon_blue.svg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.5">
    
    
      
        <title>Chat - faststream-gen</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6a10b989.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../overrides/css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-84Y5MCKH3B"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-84Y5MCKH3B",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-84Y5MCKH3B",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  
  
    
  
  
  <meta property="og:type" content="website" />
  <meta property="og:title" content="faststream-gen - Chat" />
  <meta property="og:description" content="The faststream-gen library uses advanced AI to generate FastStream code from application descriptions, speeding up FastStream app development." />
  <meta property="og:url" content="https://airtai.github.io/faststream-gen/Chat/" />
  <meta property="og:image" content="https://opengraph.githubassets.com/1691483169.608266/airtai/faststream-gen" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="faststream-gen - Chat" />
  <meta name="twitter:description" content="The faststream-gen library uses advanced AI to generate FastStream code from application descriptions, speeding up FastStream app development." />
  <meta name="twitter:image" content="https://opengraph.githubassets.com/1691483169.608266/airtai/faststream-gen" />

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="light-blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#customaichat" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../.."> 
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="faststream-gen" class="md-header__button md-logo" aria-label="faststream-gen" data-md-component="logo">
      
  <img src="../overrides/images/airt_icon_blue.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            faststream-gen
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chat
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/airtai/faststream-gen" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    faststream-gen
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="faststream-gen" class="md-nav__button md-logo" aria-label="faststream-gen" data-md-component="logo">
      
  <img src="../overrides/images/airt_icon_blue.svg" alt="logo">

    </a>
    faststream-gen
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/airtai/faststream-gen" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    faststream-gen
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code generator for FastStream
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Tutorial/Cryptocurrency_Tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptocurrency analysis with FastStream
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CLI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            CLI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../cli/faststream_gen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    faststream_gen
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../CHANGELOG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releases
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#customaichat" class="md-nav__link">
    CustomAIChat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validateandfixresponse" class="md-nav__link">
    ValidateAndFixResponse
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validateandfixresponsefix" class="md-nav__link">
    ValidateAndFixResponse.fix
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Chat</h1>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>

<span class="kn">import</span> <span class="nn">pytest</span>

<span class="kn">from</span> <span class="nn">faststream_gen._components.logger</span> <span class="kn">import</span> <span class="n">suppress_timestamps</span>
<span class="kn">from</span> <span class="nn">faststream_gen._code_generator.constants</span> <span class="kn">import</span> <span class="n">OpenAIModel</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">suppress_timestamps</span><span class="p">()</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;ok&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[INFO] __main__: ok
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nd">@_retry_with_exponential_backoff</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">mock_func</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Success&quot;</span>

<span class="n">actual</span> <span class="o">=</span> <span class="n">mock_func</span><span class="p">()</span>
<span class="n">expected</span> <span class="o">=</span> <span class="s2">&quot;Success&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">expected</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Success
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Test max retries exceeded</span>
<span class="nd">@_retry_with_exponential_backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mock_func_error</span><span class="p">():</span>
    <span class="k">raise</span> <span class="n">openai</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">RateLimitError</span>


<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">Exception</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">mock_func_error</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Maximum number of retries (1) exceeded.&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[INFO] __main__: Note: OpenAI&#39;s API rate limit reached. Command will automatically retry in 2 seconds. For more information visit: https://help.openai.com/en/articles/5955598-is-api-usage-subject-to-any-rate-limits
Maximum number of retries (1) exceeded.
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;What is FastStream?&quot;</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">_get_relevant_document</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">actual</span><span class="p">[:</span><span class="mi">200</span><span class="p">])</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[INFO] faiss.loader: Loading faiss with AVX2 support.
[INFO] faiss.loader: Successfully loaded faiss with AVX2 support.
hide:
  - navigation
  - footer

Release Notes

FastStream is a new package based on the ideas and experiences gained from FastKafka and Propan. By joining our forces, we picked up the best from both
</code></pre></div>
<hr />
<p><a
href="https://github.com/airtai/faststream-gen/blob/main/faststream_gen/_code_generator/chat.py#L107"
target="_blank" style="float:right; font-size:smaller">source</a></p>
<h3 id="customaichat">CustomAIChat<a class="headerlink" href="#customaichat" title="Permanent link">¤</a></h3>
<blockquote>
<div class="highlight"><pre><span></span><code> CustomAIChat (model:str, user_prompt:Optional[str]=None,
               params:Dict[str,float]={&#39;temperature&#39;: 0.7},
               semantic_search_query:Optional[str]=None)
</code></pre></div>
</blockquote>
<p>Custom class for interacting with OpenAI</p>
<p>Attributes: model: The OpenAI model to use. If not passed, defaults to
gpt-3.5-turbo-16k. system_prompt: Initial system prompt to the AI model.
If not passed, defaults to SYSTEM_PROMPT. initial_user_prompt: Initial
user prompt to the AI model. params: Parameters to use while initiating
the OpenAI chat model. DEFAULT_PARAMS used if not provided.</p>
<div class="highlight"><pre><span></span><code><span class="n">TEST_INITIAL_USER_PROMPT</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">You should respond with 0, 1 or 2 and nothing else. Below are your rules:</span>

<span class="s2">==== RULES: ====</span>

<span class="s2">If the ==== APP DESCRIPTION: ==== section is not related to FastKafka or contains violence, self-harm, harassment/threatening or hate/threatening information then you should respond with 0.</span>

<span class="s2">If the ==== APP DESCRIPTION: ==== section is related to FastKafka but focuses on what is it and its general information then you should respond with 1. </span>

<span class="s2">If the ==== APP DESCRIPTION: ==== section is related to FastKafka but focuses how to use it and instructions to create a new app then you should respond with 2. </span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">ai</span> <span class="o">=</span> <span class="n">CustomAIChat</span><span class="p">(</span><span class="n">user_prompt</span> <span class="o">=</span> <span class="n">TEST_INITIAL_USER_PROMPT</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">OpenAIModel</span><span class="o">.</span><span class="n">gpt3</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">response</span><span class="p">,</span> <span class="n">usage</span> <span class="o">=</span> <span class="n">ai</span><span class="p">(</span><span class="s2">&quot;Name the tallest mountain in the world&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">usage</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">response</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[INFO] __main__:

Prompt to the model:

===Role:system===

Message:

You are an expert Python developer, tasked to generate executable Python code as a part of your work with the FastStream framework.

You are to abide by the following guidelines:

1. You must never enclose the generated Python code with ``` python. It is mandatory that the output is a valid and executable Python code. Please ensure this rule is never broken.

2. Some prompts might require you to generate code that contains async functions. For example:

async def app_setup(context: ContextRepo):
    raise NotImplementedError()

In such cases, it is necessary to add the &quot;import asyncio&quot; statement at the top of the code.

You will encounter sections marked as:

==== APP DESCRIPTION: ====

These sections contain the description of the FastStream app you need to implement. Treat everything below this line, until the end of the prompt, as the description to follow for the app implementation.


===Role:user===

Message:


===Role:user===

Message:

You should respond with 0, 1 or 2 and nothing else. Below are your rules:

==== RULES: ====

If the ==== APP DESCRIPTION: ==== section is not related to FastKafka or contains violence, self-harm, harassment/threatening or hate/threatening information then you should respond with 0.

If the ==== APP DESCRIPTION: ==== section is related to FastKafka but focuses on what is it and its general information then you should respond with 1.

If the ==== APP DESCRIPTION: ==== section is related to FastKafka but focuses how to use it and instructions to create a new app then you should respond with 2.


===Role:user===

Message:
Name the tallest mountain in the world
==== YOUR RESPONSE ====

0
{
  &quot;prompt_tokens&quot;: 348,
  &quot;completion_tokens&quot;: 1,
  &quot;total_tokens&quot;: 349
}
</code></pre></div>
<hr />
<p><a
href="https://github.com/airtai/faststream-gen/blob/main/faststream_gen/_code_generator/chat.py#L178"
target="_blank" style="float:right; font-size:smaller">source</a></p>
<h3 id="validateandfixresponse">ValidateAndFixResponse<a class="headerlink" href="#validateandfixresponse" title="Permanent link">¤</a></h3>
<blockquote>
<div class="highlight"><pre><span></span><code> ValidateAndFixResponse (generate:Callable[...,Any],
                         validate:Callable[...,Any],
                         max_retries:Optional[int]=3)
</code></pre></div>
</blockquote>
<p>Generates and validates response from OpenAI</p>
<p>Attributes: generate: A callable object for generating responses.
validate: A callable object for validating responses. max_retries: An
optional integer specifying the maximum number of attempts to generate
and validate a response.</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">d</span><span class="p">:</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;role&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;content&quot;</span><span class="p">}]</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;attempt&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">step_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">]:</span>
        <span class="n">_save_log_results</span><span class="p">(</span><span class="n">step_name</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">messages</span><span class="p">,</span> <span class="s2">&quot;response&quot;</span><span class="p">,</span> <span class="s2">&quot;error_str&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">step_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">step_name</span>
        <span class="k">assert</span> <span class="n">step_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

        <span class="n">attempt_dir</span> <span class="o">=</span> <span class="n">step_dir</span> <span class="o">/</span> <span class="s2">&quot;attempt_3&quot;</span>
        <span class="k">assert</span> <span class="n">attempt_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

        <span class="n">try_dir</span> <span class="o">=</span> <span class="n">attempt_dir</span> <span class="o">/</span> <span class="s2">&quot;try_1&quot;</span>
        <span class="k">assert</span> <span class="n">try_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">try_dir</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;**/*&#39;</span><span class="p">)))</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">step_dir</span> <span class="o">/</span> <span class="s2">&quot;attempt_3&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_1&quot;</span> <span class="o">/</span> <span class="s2">&quot;input.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">step_dir</span> <span class="o">/</span> <span class="s2">&quot;attempt_3&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_1&quot;</span> <span class="o">/</span> <span class="s2">&quot;output.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">step_dir</span> <span class="o">/</span> <span class="s2">&quot;attempt_3&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_1&quot;</span> <span class="o">/</span> <span class="s2">&quot;errors.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[PosixPath(&#39;/tmp/tmp5k9i2c84/app/attempt_3/try_1/errors.txt&#39;), PosixPath(&#39;/tmp/tmp5k9i2c84/app/attempt_3/try_1/output.txt&#39;), PosixPath(&#39;/tmp/tmp5k9i2c84/app/attempt_3/try_1/input.txt&#39;)]
[PosixPath(&#39;/tmp/tmp5k9i2c84/test/attempt_3/try_1/errors.txt&#39;), PosixPath(&#39;/tmp/tmp5k9i2c84/test/attempt_3/try_1/output.txt&#39;), PosixPath(&#39;/tmp/tmp5k9i2c84/test/attempt_3/try_1/input.txt&#39;)]
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;some response&quot;</span>
<span class="n">errors</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;error 1</span>
<span class="s2">error 2</span>
<span class="s2">error 3</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">expected</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>

<span class="s2">==== YOUR RESPONSE (WITH ISSUES) ====</span>

<span class="s2">some response</span>

<span class="s2">Read the contents of ==== YOUR RESPONSE (WITH ISSUES) ==== section and fix the below mentioned issues:</span>

<span class="s2">error 1</span>
<span class="s2">error 2</span>
<span class="s2">error 3</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">_construct_prompt_with_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">errors</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">expected</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>==== YOUR RESPONSE (WITH ISSUES) ====

some response

Read the contents of ==== YOUR RESPONSE (WITH ISSUES) ==== section and fix the below mentioned issues:

error 1
error 2
error 3
</code></pre></div>
<hr />
<p><a
href="https://github.com/airtai/faststream-gen/blob/main/faststream_gen/_code_generator/chat.py#L263"
target="_blank" style="float:right; font-size:smaller">source</a></p>
<h3 id="validateandfixresponsefix">ValidateAndFixResponse.fix<a class="headerlink" href="#validateandfixresponsefix" title="Permanent link">¤</a></h3>
<blockquote>
<div class="highlight"><pre><span></span><code> ValidateAndFixResponse.fix (prompt:str, total_usage:List[Dict[str,int]],
                             step_name:str, output_directory:str,
                             **kwargs:Dict[str,Any])
</code></pre></div>
</blockquote>
<p>Fix the response from OpenAI until no errors remain or maximum number of
attempts is reached.</p>
<p>Args: prompt: The initial prompt string. kwargs: Additional keyword
arguments to be passed to the validation function.</p>
<p>Returns: str: The generated response that has passed the validation.</p>
<p>Raises: ValueError: If the maximum number of attempts is exceeded and
the response has not successfully passed the validation.</p>
<div class="highlight"><pre><span></span><code><span class="n">fixture_initial_prompt</span> <span class="o">=</span> <span class="s2">&quot;some valid prompt&quot;</span>
<span class="n">expected</span> <span class="o">=</span> <span class="s2">&quot;some valid prompt&quot;</span>
<span class="n">max_retries</span> <span class="o">=</span> <span class="mi">3</span>


<span class="k">class</span> <span class="nc">FixtureGenerate</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_prompt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">SYSTEM_PROMPT</span><span class="p">}]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prompt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">})</span>
        <span class="n">usage</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;prompt_tokens&quot;</span><span class="p">:</span> <span class="mi">129</span><span class="p">,</span> <span class="s2">&quot;completion_tokens&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;total_tokens&quot;</span><span class="p">:</span> <span class="mi">130</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">fixture_initial_prompt</span><span class="p">,</span> <span class="n">usage</span>

<span class="k">def</span> <span class="nf">fixture_validate</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">output_directory</span><span class="p">,</span> <span class="n">attempt</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">([],</span> <span class="n">response</span><span class="p">)</span>

<span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">d</span><span class="p">:</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;attempt&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">fixture_generate</span> <span class="o">=</span> <span class="n">FixtureGenerate</span><span class="p">(</span><span class="n">fixture_initial_prompt</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">ValidateAndFixResponse</span><span class="p">(</span><span class="n">fixture_generate</span><span class="p">,</span> <span class="n">fixture_validate</span><span class="p">,</span> <span class="n">max_retries</span><span class="p">)</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">fixture_initial_prompt</span><span class="p">,</span> <span class="p">[],</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">],</span> <span class="n">d</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>

    <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_1&quot;</span> <span class="o">/</span> <span class="s2">&quot;input.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_1&quot;</span> <span class="o">/</span> <span class="s2">&quot;output.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_1&quot;</span> <span class="o">/</span> <span class="s2">&quot;errors.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">((</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_1&quot;</span> <span class="o">/</span> <span class="s2">&quot;input.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[defaultdict(&lt;class &#39;int&#39;&gt;, {&#39;prompt_tokens&#39;: 129, &#39;completion_tokens&#39;: 1, &#39;total_tokens&#39;: 130})]
====system====


You are an expert Python developer, tasked to generate executable Python code as a part of your work with the FastStream framework.

You are to abide by the following guidelines:

1. You must never enclose the generated Python code with ``` python. It is mandatory that the output is a valid and executable Python code. Please ensure this rule is never broken.

2. Some prompts might require you to generate code that contains async functions. For example:

async def app_setup(context: ContextRepo):
    raise NotImplementedError()

In such cases, it is necessary to add the &quot;import asyncio&quot; statement at the top of the code.

You will encounter sections marked as:

==== APP DESCRIPTION: ====

These sections contain the description of the FastStream app you need to implement. Treat everything below this line, until the end of the prompt, as the description to follow for the app implementation.



====user====

some valid prompt
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">fixture_initial_prompt</span> <span class="o">=</span> <span class="s2">&quot;some invalid prompt&quot;</span>
<span class="n">max_retries</span> <span class="o">=</span> <span class="mi">3</span>


<span class="k">class</span> <span class="nc">FixtureGenerate</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_prompt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">SYSTEM_PROMPT</span><span class="p">}]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prompt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">})</span>
        <span class="n">usage</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;prompt_tokens&quot;</span><span class="p">:</span> <span class="mi">129</span><span class="p">,</span> <span class="s2">&quot;completion_tokens&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;total_tokens&quot;</span><span class="p">:</span> <span class="mi">130</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">fixture_initial_prompt</span><span class="p">,</span> <span class="n">usage</span>


<span class="n">fixture_generate</span> <span class="o">=</span> <span class="n">FixtureGenerate</span><span class="p">(</span><span class="n">fixture_initial_prompt</span><span class="p">)</span>

<span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">d</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">fixture_validate</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">attempt</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">([</span><span class="s2">&quot;error 1&quot;</span><span class="p">,</span> <span class="s2">&quot;error 2&quot;</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;attempt&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">ValidateAndFixResponse</span><span class="p">(</span><span class="n">fixture_generate</span><span class="p">,</span> <span class="n">fixture_validate</span><span class="p">,</span> <span class="n">max_retries</span><span class="p">)</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">fixture_initial_prompt</span><span class="p">,</span> <span class="p">[],</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">],</span> <span class="n">d</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">/</span> <span class="s2">&quot;input.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">/</span> <span class="s2">&quot;output.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">/</span> <span class="s2">&quot;errors.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">((</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_2&quot;</span> <span class="o">/</span> <span class="s2">&quot;input.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[INFO] __main__: Validation failed, trying again...Errors:
error 1
error 2
[INFO] __main__: Validation failed, trying again...Errors:
error 1
error 2
[INFO] __main__: Validation failed, trying again...Errors:
error 1
error 2
e.value=ValueError([defaultdict(&lt;class &#39;int&#39;&gt;, {&#39;prompt_tokens&#39;: 387, &#39;completion_tokens&#39;: 3, &#39;total_tokens&#39;: 390})], False)
====system====


You are an expert Python developer, tasked to generate executable Python code as a part of your work with the FastStream framework.

You are to abide by the following guidelines:

1. You must never enclose the generated Python code with ``` python. It is mandatory that the output is a valid and executable Python code. Please ensure this rule is never broken.

2. Some prompts might require you to generate code that contains async functions. For example:

async def app_setup(context: ContextRepo):
    raise NotImplementedError()

In such cases, it is necessary to add the &quot;import asyncio&quot; statement at the top of the code.

You will encounter sections marked as:

==== APP DESCRIPTION: ====

These sections contain the description of the FastStream app you need to implement. Treat everything below this line, until the end of the prompt, as the description to follow for the app implementation.



====user====

some invalid prompt


====user====



==== YOUR RESPONSE (WITH ISSUES) ====

some invalid prompt

Read the contents of ==== YOUR RESPONSE (WITH ISSUES) ==== section and fix the below mentioned issues:

error 1
error 2
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">fixture_initial_prompt</span> <span class="o">=</span> <span class="s2">&quot;some invalid prompt&quot;</span>
<span class="n">max_retries</span> <span class="o">=</span> <span class="mi">3</span>


<span class="k">class</span> <span class="nc">FixtureGenerate</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_prompt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">SYSTEM_PROMPT</span><span class="p">}]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prompt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">})</span>
        <span class="n">usage</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;prompt_tokens&quot;</span><span class="p">:</span> <span class="mi">129</span><span class="p">,</span> <span class="s2">&quot;completion_tokens&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;total_tokens&quot;</span><span class="p">:</span> <span class="mi">130</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">fixture_initial_prompt</span><span class="p">,</span> <span class="n">usage</span>


<span class="n">fixture_generate</span> <span class="o">=</span> <span class="n">FixtureGenerate</span><span class="p">(</span><span class="n">fixture_initial_prompt</span><span class="p">)</span>

<span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">d</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">fixture_validate</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">attempt</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;error 1&quot;</span><span class="p">,</span> <span class="s2">&quot;error 2&quot;</span><span class="p">]</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;attempt&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">ValidateAndFixResponse</span><span class="p">(</span><span class="n">fixture_generate</span><span class="p">,</span> <span class="n">fixture_validate</span><span class="p">,</span> <span class="n">max_retries</span><span class="p">)</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">fixture_initial_prompt</span><span class="p">,</span> <span class="p">[],</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">],</span> <span class="n">d</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">/</span> <span class="s2">&quot;input.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">/</span> <span class="s2">&quot;output.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">/</span> <span class="s2">&quot;errors.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">((</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOGS_DIR_NAME</span> <span class="o">/</span> <span class="n">STEP_LOG_DIR_NAMES</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;attempt_1&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;try_2&quot;</span> <span class="o">/</span> <span class="s2">&quot;input.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[INFO] __main__: Validation failed, trying again...Errors:
error 1
error 2
[INFO] __main__: Validation failed, trying again...Errors:
error 1
error 2
[INFO] __main__: Validation failed, trying again...Errors:
error 1
error 2
([defaultdict(&lt;class &#39;int&#39;&gt;, {&#39;prompt_tokens&#39;: 387, &#39;completion_tokens&#39;: 3, &#39;total_tokens&#39;: 390})], False)
====system====


You are an expert Python developer, tasked to generate executable Python code as a part of your work with the FastStream framework.

You are to abide by the following guidelines:

1. You must never enclose the generated Python code with ``` python. It is mandatory that the output is a valid and executable Python code. Please ensure this rule is never broken.

2. Some prompts might require you to generate code that contains async functions. For example:

async def app_setup(context: ContextRepo):
    raise NotImplementedError()

In such cases, it is necessary to add the &quot;import asyncio&quot; statement at the top of the code.

You will encounter sections marked as:

==== APP DESCRIPTION: ====

These sections contain the description of the FastStream app you need to implement. Treat everything below this line, until the end of the prompt, as the description to follow for the app implementation.



====user====

some invalid prompt


====user====



==== YOUR RESPONSE (WITH ISSUES) ====

some invalid prompt

Read the contents of ==== YOUR RESPONSE (WITH ISSUES) ==== section and fix the below mentioned issues:

error 1
error 2
</code></pre></div>


  




                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2023 onwards, airt
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
    and 
    <a href="https://nbdev-mkdocs.airt.ai/" target="_blank" rel="noopener">
      Material for nbdev
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "search.share", "content.code.copy"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../overrides/js/extra.js"></script>
      
        <script src="../overrides/js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>